<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZTA Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family: "Poppins", sans-serif; }
body { background:#000; color:#fff; overflow:hidden; }

#stars {
    position:fixed;
    width:100%;
    height:100%;
    top:0; left:0;
    z-index:-1;
}

/* ---------------------------- */
/*      ADMIN PANEL UI          */
/* ---------------------------- */

.header {
    background:#0f0f16;
    padding:20px;
    font-size:30px;
    text-align:center;
    letter-spacing:3px;
    border-bottom:2px solid #1aff9c;
}

.container {
    padding:20px;
    height:87vh;
    overflow-y:auto;
}

.searchBox {
    width:100%;
    padding:12px;
    font-size:18px;
    border:2px solid #1aff9c;
    background:#111;
    color:#1aff9c;
    margin-bottom:20px;
    border-radius:8px;
}

.table {
    width:100%;
    border-collapse:collapse;
}

.table th {
    padding:15px;
    background:#111;
    color:#1aff9c;
    font-size:18px;
    border-bottom:2px solid #1aff9c;
}

.table td {
    padding:12px;
    border-bottom:1px solid #333;
}

.rank-badge {
    padding:6px 12px;
    border-radius:6px;
    font-size:14px;
    color:#000;
    font-weight:bold;
}

/* Dynamic rank colors */
[data-rank="Starlight Beginner"] { background:#b3faff; }
[data-rank="Night Sky Explorer"] { background:#7bf0ff; }
[data-rank="Star Tracker"] { background:#6dff97; }
[data-rank="Meteor Master"] { background:#ffe073; }
[data-rank="Galaxy Seeker"] { background:#ffb6b6; }
[data-rank="Universe Prime"] { background:#ff5b5b; }

/* Buttons */
.btn {
    padding:8px 14px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    margin-right:5px;
}

.btn-delete { background:#ff4d4d; color:#000; }
.btn-rank { background:#1aff9c; color:#000; }
</style>
</head>

<body>

<canvas id="stars"></canvas>

<div class="header">ðŸ”¥ ZTA ADMIN PANEL ðŸ”¥</div>

<div class="container">

    <input type="text" id="search" class="searchBox" placeholder="Search user by name, email, rank...">

    <table class="table" id="userTable">
        <thead>
            <tr>
                <th>User</th>
                <th>Email</th>
                <th>Rank</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="membersBody">
        </tbody>
    </table>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script>
// YOUR FIREBASE CONFIG
const firebaseConfig = {
  apiKey: "AIzaSyDelkwsOVmHcGrP4MV6o0weFrPyrjsExvM",
  authDomain: "zerox-a7ed6.firebaseapp.com",
  projectId: "zerox-a7ed6",
  storageBucket: "zerox-a7ed6.firebasestorage.app",
  messagingSenderId: "847831795606",
  appId: "1:847831795606:web:43f71bc1cc8f7f9bbe7fb7",
  measurementId: "G-MCRR6C3XQ8"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const membersBody = document.getElementById("membersBody");
const search = document.getElementById("search");

// LIVE LOAD ALL USERS
db.collection("users").onSnapshot(res => {
    membersBody.innerHTML = "";

    res.forEach(doc => {
        const u = doc.data();
        const id = doc.id;

        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${u.name || "No Name"}</td>
            <td>${u.email || "No Email"}</td>
            <td><span class="rank-badge" data-rank="${u.rank || "None"}">${u.rank || "None"}</span></td>

            <td>
                <button class="btn btn-rank" onclick="editRank('${id}')">Rank</button>
                <button class="btn btn-delete" onclick="deleteUser('${id}')">Delete</button>
            </td>
        `;

        membersBody.appendChild(tr);
    });
});

// DELETE USER
function deleteUser(uid) {
    if (!confirm("Delete this user?")) return;
    db.collection("users").doc(uid).delete();
    alert("User deleted!");
}

// EDIT RANK
function editRank(uid) {
    const newRank = prompt("Enter new rank:");

    if (!newRank) return;

    db.collection("users").doc(uid).update({
        rank: newRank
    });

    alert("Rank updated!");
}

// SEARCH
search.addEventListener("keyup", () => {
    let v = search.value.toLowerCase();
    let rows = membersBody.getElementsByTagName("tr");

    for (let row of rows) {
        let txt = row.innerText.toLowerCase();
        row.style.display = txt.includes(v) ? "" : "none";
    }
});

/* ---------------------------------- */
/* STARFIELD BACKGROUND               */
/* ---------------------------------- */
const canvas = document.getElementById("stars");
const ctx = canvas.getContext("2d");
let w = canvas.width = innerWidth;
let h = canvas.height = innerHeight;

let stars = [];
for (let i=0;i<1000;i++){
    stars.push({
        x: Math.random()*w,
        y: Math.random()*h,
        r: Math.random()*2,
        s: Math.random()*1+0.2
    });
}

function animate() {
    ctx.clearRect(0,0,w,h);
    ctx.fillStyle="#1aff9c";

    stars.forEach(s=>{
        ctx.globalAlpha=s.s;
        ctx.beginPath();
        ctx.arc(s.x,s.y,s.r,0,2*Math.PI);
        ctx.fill();
        s.y +=0.6;
        if(s.y>h) s.y=0;
    });

    requestAnimationFrame(animate);
}
animate();

window.addEventListener("resize",()=>{
    w=canvas.width=innerWidth;
    h=canvas.height=innerHeight;
});
</script>

</body>
</html>
