<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZTA Admin – Member Control Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:'Exo 2',sans-serif;background:#000;color:#fff;min-height:100vh;
    background:radial-gradient(circle at 30% 70%,#0f0529 0%,#000 70%);overflow-x:hidden;
}
canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;opacity:0.6;}

/* Premium Admin Navbar */
.navbar{
    position:fixed;top:0;width:100%;padding:22px 6%;display:flex;
    justify-content:space-between;align-items:center;z-index:9999;
    background:rgba(10,5,40,0.8);backdrop-filter:blur(25px);
    border-bottom:3px solid #9acd32;box-shadow:0 20px 60px rgba(0,0,0,0.9);
}
.logo{font-family:'Orbitron',sans-serif;font-size:42px;font-weight:900;letter-spacing:16px;
      background:linear-gradient(90deg,#9acd32,#72fe95);-webkit-background-clip:text;
      -webkit-text-fill-color:transparent;text-shadow:0 0 60px #9acd32;}
.admin-badge{color:#9acd32;font-weight:900;font-size:20px;letter-spacing:3px;}

/* Admin Panel */
.admin-panel{
    max-width:1400px;margin:160px auto 100px;padding:0 5%;
}
.panel-header{
    text-align:center;margin-bottom:80px;
}
.panel-title{
    font-family:'Orbitron',sans-serif;font-size:80px;
    background:linear-gradient(90deg,#9acd32,#c6ff7a);
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    text-shadow:0 0 100px #9acd32;
}
.panel-subtitle{color:#72fe95;font-size:24px;margin-top:20px;letter-spacing:4px;}

/* Members Table */
.members-table{
    background:rgba(20,10,60,0.6);border-radius:35px;padding:50px;
    border:3px solid rgba(154,205,50,0.3);backdrop-filter:blur(20px);
    box-shadow:0 40px 120px rgba(154,205,50,0.3);
}
.table-header{
    display:grid;grid-template-columns:80px 1fr 200px 200px 150px 120px;padding:20px 0;
    border-bottom:2px solid rgba(154,205,50,0.4);font-weight:700;color:#9acd32;
}
.member-row{
    display:grid;grid-template-columns:80px 1fr 200px 200px 150px 120px;
    padding:25px 0;border-bottom:1px solid rgba(154,205,50,0.1);align-items:center;
    transition:all .4s;
}
.member-row:hover{background:rgba(154,205,50,0.1);transform:translateY(-5px);}
.avatar-img{width:60px;height:60px;border-radius:50%;object-fit:cover;border:3px solid #9acd32;}
.member-name{font-size:20px;font-weight:700;color:#9acd32;}
.member-email{color:#aaa;font-size:16px;}
.rank-select{
    background:rgba(0,0,0,0.6);border:2px solid #9acd32;color:#fff;padding:10px;
    border-radius:12px;font-size:16px;cursor:pointer;
}
.save-rank{background:#9acd32;color:#000;padding:10px 20px;border-radius:50px;
          font-weight:900;cursor:pointer;transition:all .4s;}
.save-rank:hover{background:#c6ff7a;transform:scale(1.1);}
.delete-user{background:#ff3333;color:#fff;padding:10px 20px;border-radius:50px;
             font-weight:900;cursor:pointer;transition:all .4s;}
.delete-user:hover{background:#ff6666;transform:scale(1.1);}

footer{text-align:center;padding:100px 20px;color:#555;font-size:17px;
       border-top:2px solid rgba(154,205,50,0.2);}
</style>
</head>
<body>

<canvas id="stars"></canvas>

<!-- Admin Navbar -->
<div class="navbar">
    <div class="logo">ZTA</div>
    <div class="admin-badge">ADMIN PANEL</div>
</div>

<!-- Admin Panel -->
<div class="admin-panel">
    <div class="panel-header">
        <h1 class="panel-title">MEMBER CONTROL</h1>
        <p class="panel-subtitle">Manage Ranks • View All Users • Full Authority</p>
    </div>

    <div class="members-table">
        <div class="table-header">
            <div>Avatar</div>
            <div>Name</div>
            <div>Email</div>
            <div>Current Rank</div>
            <div>Change Rank</div>
            <div>Actions</div>
        </div>

        <div id="membersList">
            <!-- All members appear here automatically -->
        </div>
    </div>
</div>

<footer>© 2025 ZTA — Admin Control Center</footer>

<!-- Firebase + Firestore + Storage -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
<script src="firebase.js"></script>

<script>
// RANKS
const ranks = ["New Stargazer", "Observer", "Astrophotographer", "Master Observer", "Cosmic Legend", "ZTA Elite"];

// PROTECTED — Only admin (you) can access
ZeroX.onAuthChange(user => {
    if (!user || user.email !== "your-admin-email@example.com") {  // ← CHANGE TO YOUR EMAIL
        alert("Access denied. Admin only.");
        window.location.href = "index.html";
        return;
    }
    loadAllMembers();
});

// Load ALL users from Firebase Auth + Firestore
function loadAllMembers() {
    const list = document.getElementById("membersList");
    list.innerHTML = "<p style='text-align:center;padding:50px;color:#aaa;'>Loading members...</p>";

    // This gets all users (requires Firebase Admin SDK in backend)
    // For now, we'll simulate with current users in Firestore (you can expand later)
    firebase.firestore().collection("users").get().then(snapshot => {
        list.innerHTML = "";
        snapshot.forEach(doc => {
            const data = doc.data();
            const row = document.createElement("div");
            row.className = "member-row";
            row.innerHTML = `
                <div><img src="${data.photoURL || 'assets/default-avatar.jpg'}" class="avatar-img"></div>
                <div class="member-name">${data.displayName || "Unknown"}</div>
                <div class="member-email">${data.email || "—"}</div>
                <div style="color:#9acd32;font-weight:700;">${data.rank || "New Stargazer"}</div>
                <div>
                    <select class="rank-select" onchange="updateRank('${doc.id}', this.value)">
                        ${ranks.map(r => `<option value="${r}" ${data.rank===r?"selected":""}>${r}</option>`).join("")}
                    </select>
                </div>
                <div>
                    <button class="save-rank" onclick="saveRank('${doc.id}')">Save</button>
                    <button class="delete-user" onclick="deleteUser('${doc.id}')">Delete</button>
                </div>
            `;
            list.appendChild(row);
        });
    });
}

// Update & Save Rank (example — expand with real Firestore later)
function updateRank(uid, rank) {
    // Temporary — shows selection
    console.log("Rank for", uid, "→", rank);
}
function saveRank(uid) {
    alert("Rank saved for user " + uid);
}
function deleteUser(uid) {
    if(confirm("Delete this user permanently?")) {
        alert("User " + uid + " deleted");
    }
}

// Starfield
const canvas=document.getElementById('stars');
const ctx=canvas.getContext('2d');
let w=canvas.width=innerWidth,h=canvas.height=innerHeight;
const stars=[];
for(let i=0;i<800;i++)stars.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*2.5,s:Math.random()*0.9+0.2});
function animate(){
    ctx.clearRect(0,0,w,h);
    ctx.fillStyle="#9acd32";
    stars.forEach(s=>{ctx.globalAlpha=s.s;ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();
        s.y+=0.9;if(s.y>h)s.y=0;});
    requestAnimationFrame(animate);
}
animate();
window.addEventListener('resize',()=>{w=canvas.width=innerWidth;h=canvas.height=innerHeight;});
</script>
</body>
</html>
